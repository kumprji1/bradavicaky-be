(this["webpackJsonpbradavicaky-fe"]=this["webpackJsonpbradavicaky-fe"]||[]).push([[0],{34:function(e,t,n){},37:function(e,t,n){},42:function(e,t,n){},43:function(e,t,n){},44:function(e,t,n){},45:function(e,t,n){"use strict";n.r(t);var a,r=n(0),s=n.n(r),c=n(26),i=n.n(c),o=(n(34),n(13)),u=n(3),l=n(7),p=Object(r.createContext)({userId:null,username:null,name:null,surname:null,role:null,token:null,login:function(){},logout:function(){}}),j=n(5),m=n.n(j),b=n(12),d=n(2),h=function(){var e=Object(r.useState)(!1),t=Object(l.a)(e,2),n=t[0],a=t[1],s=Object(r.useState)(),c=Object(l.a)(s,2),i=c[0],o=c[1],u=Object(r.useRef)([]),p=Object(r.useCallback)(function(){var e=Object(b.a)(m.a.mark((function e(t){var n,r,s,c,i,l,p=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=p.length>1&&void 0!==p[1]?p[1]:"GET",r=p.length>2&&void 0!==p[2]?p[2]:null,s=p.length>3&&void 0!==p[3]?p[3]:{},a(!0),c=new AbortController,u.current.push(c),e.prev=6,e.next=9,fetch(t,{method:n,body:r,headers:s,signal:c.signal});case 9:return i=e.sent,e.next=12,i.json();case 12:if(l=e.sent,u.current=u.current.filter((function(e){return e!==c})),i.ok){e.next=16;break}throw new Error(l.msg);case 16:return a(!1),e.abrupt("return",l);case 20:throw e.prev=20,e.t0=e.catch(6),o(e.t0.msg),a(!1),e.t0;case 25:case"end":return e.stop()}}),e,null,[[6,20]])})));return function(t){return e.apply(this,arguments)}}(),[]);return Object(r.useEffect)((function(){return function(){u.current.forEach((function(e){return e.abort()}))}}),[]),{isLoading:n,error:i,sendRequest:p,clearError:function(){o(null)}}},O=(n(37),n(1)),f=function(){var e=Object(r.useContext)(p),t=h().sendRequest,n=function(){var n=Object(b.a)(m.a.mark((function n(a){var r;return m.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t("http://localhost:5000/api/auth/login","POST",JSON.stringify({username:a.username,password:a.password}),{"Content-type":"application/json"});case 3:r=n.sent,n.next=8;break;case 6:n.prev=6,n.t0=n.catch(0);case 8:e.login(r._id,r.username,r.name,r.surname,r.role,r.token);case 9:case"end":return n.stop()}}),n,null,[[0,6]])})));return function(e){return n.apply(this,arguments)}}();return Object(O.jsx)("div",{className:"form--wrapper",children:Object(O.jsx)(d.c,{initialValues:{username:"",password:""},onSubmit:n,children:Object(O.jsxs)(d.b,{className:"custom_form",children:[Object(O.jsx)(d.a,{className:"text-input",name:"username",type:"text",placeholder:"U\u017eivatelsk\xe9 jm\xe9no"}),Object(O.jsx)(d.a,{className:"text-input",name:"password",type:"password",placeholder:"Heslo"}),Object(O.jsx)("button",{className:"button-submit",type:"submit",children:"Alohomora"})]})})})},x=function(){var e=Object(u.f)(),t=h().sendRequest,n=function(){var n=Object(b.a)(m.a.mark((function n(a){return m.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log("N\xe1slednuje odesl\xe1n\xed po\u017eadavku registrace admina"),n.prev=1,n.next=4,t("".concat("https://bradavicaky.herokuapp.com","/api/auth/register-admin"),"POST",JSON.stringify(a),{"content-type":"application/json"});case 4:e.push("/prihlaseni"),n.next=9;break;case 7:n.prev=7,n.t0=n.catch(1);case 9:case"end":return n.stop()}}),n,null,[[1,7]])})));return function(e){return n.apply(this,arguments)}}();return Object(O.jsxs)("div",{children:[Object(O.jsx)("p",{children:"Registrace admina"}),Object(O.jsx)(d.c,{initialValues:{username:"",name:"",surname:"",password:"",rePassword:""},onSubmit:n,children:Object(O.jsxs)(d.b,{children:[Object(O.jsx)(d.a,{name:"username",type:"text",placeholder:"U\u017eivatelsk\xe9 jm\xe9no"}),Object(O.jsx)(d.a,{name:"name",type:"text",placeholder:"Jm\xe9no"}),Object(O.jsx)(d.a,{name:"surname",type:"text",placeholder:"P\u0159\xedjmen\xed"}),Object(O.jsx)(d.a,{name:"password",type:"password",placeholder:"Heslo"}),Object(O.jsx)(d.a,{name:"rePassword",type:"password",placeholder:" Heslo znovu"}),Object(O.jsx)("button",{type:"submit",children:"Registrace"})]})})]})},v=function(){var e=Object(u.f)(),t=Object(r.useState)(""),n=Object(l.a)(t,2),a=n[0],s=n[1],c=h(),i=c.sendRequest,o=c.error,p=function(){var t=Object(b.a)(m.a.mark((function t(n){var a;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i("".concat("https://bradavicaky.herokuapp.com","/api/admin/register-pupil"),"POST",JSON.stringify(n),{"content-type":"application/json"});case 3:a=t.sent,s(a.msg),setTimeout((function(){return e.push("/")}),1e3),t.next=10;break;case 8:t.prev=8,t.t0=t.catch(0);case 10:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}();return Object(O.jsx)("div",{className:"form--wrapper",children:Object(O.jsx)(d.c,{initialValues:{username:"",name:"",surname:"",password:"",rePassword:"",college:"nebelvir"},onSubmit:p,children:Object(O.jsxs)(d.b,{className:"custom_form",children:[Object(O.jsx)(d.a,{type:"hidden"}),Object(O.jsx)(d.a,{className:"text-input",name:"username",type:"text",placeholder:"U\u017eivatelsk\xe9 jm\xe9no"}),Object(O.jsx)(d.a,{className:"text-input",name:"name",type:"text",placeholder:"Jm\xe9no"}),Object(O.jsx)(d.a,{className:"text-input",name:"surname",type:"text",placeholder:"P\u0159\xedjmen\xed"}),Object(O.jsx)(d.a,{className:"text-input",name:"password",type:"password",placeholder:"Heslo"}),Object(O.jsx)(d.a,{className:"text-input",name:"rePassword",type:"password",placeholder:" Heslo znovu"}),Object(O.jsxs)(d.a,{as:"select",name:"college",children:[Object(O.jsx)("option",{value:"nebelv\xedr",children:"Nebelv\xedr"}),Object(O.jsx)("option",{value:"mrzimor",children:"Mrzimor"}),Object(O.jsx)("option",{value:"havrasp\xe1r",children:"Havrasp\xe1r"}),Object(O.jsx)("option",{value:"zmijozel",children:"Zmijozel"})]}),Object(O.jsx)("button",{className:"button-submit",type:"submit",children:"Registrace"}),Object(O.jsxs)("p",{className:"responseMsg",children:[a,o]})]})})})},k=(n(42),function(){var e=Object(r.useState)([]),t=Object(l.a)(e,2),n=t[0],a=t[1],s=h().sendRequest;Object(r.useEffect)((function(){var e=function(){var e=Object(b.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s("".concat("https://bradavicaky.herokuapp.com","/api/admin/pupils"));case 3:t=e.sent,a(t),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();e(),console.log("fetchPupils()")}),[]);var c,i=function(){var e=Object(b.a)(m.a.mark((function e(t,n){var r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s("".concat("https://bradavicaky.herokuapp.com","/api/admin/add-points"),"PATCH",JSON.stringify({pupilsId:t,points:n}),{"Content-type":"application/json"});case 2:"success"===(r=e.sent).msg&&a((function(e){return e.map((function(e){return e._id===t&&(e.points=r.points),e}))}));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),o=function(){var e=Object(b.a)(m.a.mark((function e(t,n){var r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s("".concat("https://bradavicaky.herokuapp.com","/api/admin/remove-points"),"PATCH",JSON.stringify({pupilsId:t,points:n}),{"Content-type":"application/json"});case 2:"success"===(r=e.sent).msg&&a((function(e){return e.map((function(e){return e._id===t&&(e.points=r.points),e}))}));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return Object(O.jsxs)("div",{className:"pupils_page--wrapper",children:[Object(O.jsx)("h1",{className:"pupils_page--title",children:"\u010carod\u011bjov\xe9"}),Object(O.jsx)("ul",{className:"pupils_page--pupils",children:n&&(c=n,console.log(c),c.map((function(e){return Object(O.jsxs)("li",{className:"pupils_page--pupil",children:[Object(O.jsxs)("span",{className:"pupils_page--pupil__name",children:[e.surname," ",e.name]}),Object(O.jsxs)("div",{className:"pupils_page--pupil--points_wrapper",children:[Object(O.jsx)("button",{onClick:function(){return o(e._id,5)},className:"pupils_page--pupil__minus--button",children:"-"}),Object(O.jsx)("span",{className:"pupils_page--pupil__points",children:e.points}),Object(O.jsx)("button",{onClick:function(){return i(e._id,5)},className:"pupils_page--pupil__plus--button",children:"+"})]})]},e._id)})))})]})}),g="admin",w="pupil",_=(n(43),function(){var e=Object(r.useState)(!1),t=Object(l.a)(e,2),n=t[0],a=t[1],s=Object(r.useContext)(p),c=[Object(O.jsx)(o.c,{className:"mobile_nav__link",to:"/registrace-zaka",onClick:function(){return a(!1)},children:"Registrace \u017e\xe1ka"},"0"),Object(O.jsx)(o.c,{className:"mobile_nav__link",to:"/",onClick:function(){return a(!1)},children:"Seznam \u017e\xe1k\u016f"},"1")],i=Object(O.jsx)(r.Fragment,{children:Object(O.jsx)(o.c,{className:"mobile_nav__link",to:"/random-user-link",onClick:function(){return a(!1)},children:"Random user link"},"2")});return s.token?Object(O.jsxs)("aside",{className:"mobile_nav--wrapper ".concat(n?"mobile_nav--showed":""),children:[Object(O.jsx)("div",{className:"mobile_nav--show_button",onClick:function(){return a((function(e){return!e}))},children:"MENU"}),Object(O.jsx)("nav",{className:"mobile_nav",children:Object(O.jsxs)("ul",{className:"mobile_nav__links",children:[!s.token&&Object(O.jsx)(o.c,{className:"mobile_nav__link",to:"/prihlaseni",onClick:function(){return a(!1)},children:"P\u0159ihl\xe1\u0161en\xed"},"3"),s.role===g&&c,s.role===w&&i,s.token&&Object(O.jsx)(o.b,{className:"mobile_nav__link",to:"/prihlaseni",onClick:function(){s.logout(),a(!1)},children:"Odhl\xe1sit se"},"4")]})})]}):null});n(44);var y=function(){var e=function(){var e=Object(r.useState)(),t=Object(l.a)(e,2),n=t[0],s=t[1],c=Object(r.useState)(),i=Object(l.a)(c,2),o=i[0],u=i[1],p=Object(r.useState)(),j=Object(l.a)(p,2),m=j[0],b=j[1],d=Object(r.useState)(),h=Object(l.a)(d,2),O=h[0],f=h[1],x=Object(r.useState)(),v=Object(l.a)(x,2),k=v[0],g=v[1],w=Object(r.useState)(),_=Object(l.a)(w,2),y=_[0],N=_[1],S=Object(r.useState)(),C=Object(l.a)(S,2),P=C[0],T=C[1],I=Object(r.useCallback)((function(e,t,n,a,r,c,i){s(e),u(t),b(n),f(a),g(r),N(c);var o=i||new Date((new Date).getTime()+36e6);T(o),localStorage.setItem("userData",JSON.stringify({userId:e,username:t,name:n,surname:a,role:r,token:c,expiration:o.toISOString()}))}),[]),J=Object(r.useCallback)((function(){s(null),u(null),b(null),f(null),g(null),N(null),T(null),localStorage.removeItem("userData")}),[]);return Object(r.useEffect)((function(){if(y&&P){var e=P.getTime()-(new Date).getTime();a=setTimeout(J,e)}else clearTimeout(a)}),[y,J,P]),Object(r.useEffect)((function(){var e=JSON.parse(localStorage.getItem("userData"));e&&e.token&&new Date(e.expiration)>new Date&&I(e.userId,e.username,e.name,e.surname,e.role,e.token,new Date(e.expiration))}),[I]),{userId:n,username:o,name:m,surname:O,role:k,token:y,login:I,logout:J}}();return Object(O.jsx)(p.Provider,{value:e,children:Object(O.jsx)("div",{className:"app",children:Object(O.jsxs)(o.a,{children:[Object(O.jsx)(_,{}),Object(O.jsxs)(u.c,{children:[Object(O.jsx)(u.a,{path:"/registrace-admina",component:x}),e.role===g&&Object(O.jsx)(u.a,{path:"/registrace-zaka",component:v}),e.role===g&&Object(O.jsx)(u.a,{path:"/",component:k}),!e.token&&Object(O.jsx)(u.a,{path:"/prihlaseni",component:f}),!e.token&&Object(O.jsx)(u.a,{path:"/",component:f})]})]})})})},N=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,46)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,s=t.getLCP,c=t.getTTFB;n(e),a(e),r(e),s(e),c(e)}))};i.a.render(Object(O.jsx)(s.a.StrictMode,{children:Object(O.jsx)(y,{})}),document.getElementById("root")),N()}},[[45,1,2]]]);
//# sourceMappingURL=main.e72ac729.chunk.js.map